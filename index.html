<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Liga de Baloncesto Autom√°tica</title>
<style>
body{margin:0;font-family:system-ui;background:#0e1320;color:#fff;}
header{background:#141a33;padding:10px 20px;position:sticky;top:0;z-index:5}
main{display:grid;gap:12px;padding:20px;grid-template-columns:1fr 1fr;}
@media(max-width:900px){main{grid-template-columns:1fr;}}
.card{background:#1c2444;border-radius:10px;padding:15px;border:1px solid #2a335a;}
button{cursor:pointer;border-radius:6px;padding:8px 12px;border:1px solid #2a335a;font-weight:600;}
button.primary{background:#4da3ff;color:#021023;}
button.ok{background:#2ecc71;color:#021015;}
button.bad{background:#ff5c5c;color:#230000;}
textarea{width:100%;height:130px;background:#0f152b;color:#fff;border:1px solid #2a335a;border-radius:8px;padding:8px;}
.pill{display:inline-block;background:#232b55;border:1px solid #2a335a;border-radius:999px;padding:4px 10px;margin:2px;font-size:13px;}
.team{background:#212845;padding:10px;border-radius:8px;margin-bottom:10px;}
.chip{display:inline-block;background:#28335e;padding:5px 8px;border-radius:8px;margin:2px;}
</style>
</head>
<body>
<header><h2>üèÄ Sistema Autom√°tico de Liga</h2></header>
<main>
<section class="card">
<h3>Cargar jugadores</h3>
<textarea id="seed" placeholder="Ejemplo:
1. Max Diclo
2. Juan (invitado)
3. Pedro"></textarea>
<button class="primary" id="load">Cargar</button>
<hr>
<h4>Liga</h4><div id="liga" class="queue"></div>
<h4>Invitados</h4><div id="invitados" class="queue"></div>
</section>
<section class="card">
<h3>Partido</h3>
<div id="estado"></div>
<div class="team"><h4>Equipo A</h4><div id="A"></div></div>
<div class="team"><h4>Equipo B</h4><div id="B"></div></div>
<button class="ok" id="ganaA">Gana Equipo A</button>
<button class="bad" id="ganaB">Gana Equipo B</button>
<button class="primary" id="siguiente">‚û°Ô∏è Siguiente Partido</button>
</section>
</main>

<script>
let liga=[],invitados=[],campeon=[],racha=0,standby=[],A=[],B=[],ultimoEnCancha=new Set(),modo='idle',nPartido=0;
function $(x){return document.querySelector(x);}
function render(){
 $("#liga").innerHTML=liga.map(n=>`<span class='pill'>${n}</span>`).join('');
 $("#invitados").innerHTML=invitados.map(n=>`<span class='pill'>${n}</span>`).join('');
 $("#A").innerHTML=A.map(n=>`<span class='pill'>${n}</span>`).join('');
 $("#B").innerHTML=B.map(n=>`<span class='pill'>${n}</span>`).join('');
 $("#estado").innerHTML=`<div class='chip'>Partido: ${nPartido}</div> 
 <div class='chip'>Racha: ${racha}</div> 
 <div class='chip'>Modo: ${modo}</div> 
 <div class='chip'>Campe√≥n: ${campeon.join(', ')||'‚Äî'}</div> 
 <div class='chip'>Standby: ${standby.join(', ')||'‚Äî'}</div>`;
}
function parseLista(txt){
 const l=txt.split('\n').map(s=>s.replace(/^\d+\W*/,'').trim()).filter(Boolean);
 const L=[],I=[];
 for(const n of l){/\(invitado\)/i.test(n)?I.push(n.replace(/\(invitado\)/i,'').trim()):L.push(n);}
 return {L,I};
}
function tomar(q,n,ex=new Set()){const o=[];let c=0;while(o.length<n&&q.length&&c<q.length*3){const v=q.shift();if(!ex.has(v))o.push(v);q.push(v);c++;}return o;}
function partida1(){
 const p=liga.splice(0,10);
 const mezclado=p.sort(()=>Math.random()-0.5);
 A=mezclado.slice(0,5);B=mezclado.slice(5);
 modo='normal';nPartido=1;
 ultimoEnCancha=new Set([...A,...B]);
}
function retador(){let L=tomar(liga,3),G=tomar(invitados,2);if(G.length<2)G=G.concat(tomar(liga,2-G.length));return L.concat(G);}
function partidoNormal(){
 A=campeon.slice();B=retador();modo='normal';nPartido++;ultimoEnCancha=new Set([...A,...B]);
}
function partido10nuevos(){
 const ex=new Set(ultimoEnCancha);
 let aL=tomar(liga,3,ex),aG=tomar(invitados,2,ex);
 if(aG.length<2)aL=aL.concat(tomar(liga,2-aG.length,ex));
 let bL=tomar(liga,3,ex),bG=tomar(invitados,2,ex);
 if(bG.length<2)bL=bL.concat(tomar(liga,2-bG.length,ex));
 A=aL.concat(aG);B=bL.concat(bG);modo='standby';nPartido++;ultimoEnCancha=new Set([...A,...B]);
}
function siguiente(){
 if(nPartido===0)return partida1();
 if(standby.length&&modo!=='standby'&&campeon.length){A=campeon.slice();B=standby.slice();standby=[];modo='normal';nPartido++;return render();}
 if(campeon.length===5&&racha>=2){standby=campeon.slice();campeon=[];racha=0;partido10nuevos();return;}
 if(modo==='standby'){partidoNormal();return;}
 if(campeon.length===5){partidoNormal();return;}
}
function gana(quien){
 if(modo==='idle')return;
 const AA=A.slice(),BB=B.slice();
 if(modo==='standby'){
   const win=(quien==='A'?AA:BB),lose=(quien==='A'?BB:AA);
   campeon=win.slice();racha=1;modo='normal';
   for(const n of lose){if(invitados.includes(n))invitados.push(invitados.splice(invitados.indexOf(n),1)[0]);else liga.push(liga.splice(liga.indexOf(n),1)[0]);}
 }else{
   if(!campeon.length){campeon=(quien==='A'?AA:BB);racha=1;}
   else{
     const ganaCampeon=(quien==='A');
     if(ganaCampeon){racha++;if(racha>=2){standby=campeon.slice();campeon=[];racha=0;partido10nuevos();render();return;}}
     else{racha=1;campeon=(quien==='A'?AA:BB);}
   }
 }
 modo='idle';render();
}
$("#load").onclick=()=>{const {L,I}=parseLista($("#seed").value);liga=L;invitados=I;campeon=[];racha=0;standby=[];modo='idle';nPartido=0;render();}
$("#siguiente").onclick=()=>{siguiente();render();}
$("#ganaA").onclick=()=>{gana('A');}
$("#ganaB").onclick=()=>{gana('B');}
render();
</script>
</body>
</html>
